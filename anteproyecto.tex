\chapter{Anteproyecto de Tesis}

Primeramente se describirá en qué consiste el proceso de descubrimiento de variantes, dando una breve introducción a la genética y al \textit{ADN}. Se describirá desde donde se parte y cuales son los objetivos a cumplir durante la realización de esta tesis. Finalmente se presentará un desglose de las tareas que se llevarán a cabo para alcanzar los objetivos propuestos y cuál será su planificación.\\

\section{Introducción al descubrimiento de variantes}

\subsection{Introducción al ADN}

El \textit{ADN} \cite{molecularbio} (ácido desoxirribonucleico) contiene las instrucciones genéticas usadas en el desarrollo y funcionamiento de todos los organismos vivos conocidos y algunos virus, y es responsable de su transmisión hereditaria. Se puede comparar el ADN con una receta o código, ya que a partir del mismo se obtienen las instrucciones necesarias para construir las células. Los segmentos de ADN que contienen esta información son los denominados genes, mientras que el resto de secuencias tienen propósitos estructurales y reguladores en el uso de esta información. En la Figura \ref{fig:adn} tenemos la representación gráfica que muestra dónde reside el ADN.\\

\begin{figure}
\centering
\includegraphics[width=0.5\textwidth]{adn.png}
\caption{¿Dónde se encuentra el ADN?.\label{fig:adn}}
\end{figure} 

El ADN es un polímero de nucleótidos, está formado por muchas unidades simples (nucleótidos) conectadas entre sí (Figura \ref{fig:adnquimic}). Los nucleótidos están formados por un azúcar, una base nitrogenada (pueden ser Adenina, Timina, Citosina y Guanina) y un grupo fosfato para interconectarlos. Puesto que lo único que distingue a un nucleótido de otro es la base nitrogenada, la secuencia de ADN se representa por una secuencia de estas bases. En estas secuencias cada base se representa por su inicial, por lo que tienen una representación del tipo \textit{AGTCTAGATCG}\ldots En los organismos vivos el ADN se presenta como una doble cadena de nucleótidos.\\

\begin{figure}
\centering
\includegraphics[width=0.4\textwidth]{adnquimic.png}
\caption{Representación química del ADN.\label{fig:adnquimic}}
\end{figure} 

Como ya se ha dicho, un gen es una secuencia del ADN que contiene información genética. Un gen es una unidad de herencia que influye en una característica particular de un organismo (como el color de los ojos, por ejemplo). A partir de los genes se producen las proteínas del organismo, que son las encargadas de generar los músculos, pelo, enzimas\ldots\\

\subsection{Descripción del proceso de descu\-bri\-mien\-to de variantes}

Puesto que un cambio en el ADN puede traducirse en un cambio brusco de las proteínas que genera el organismo, esto puede dar lugar a trastornos, enfermedades, etc. El proceso de descubrimiento de variantes tiene como objetivo localizar variaciones, mutaciones o \textit{indels} (\textit{insertions/deletions}) en una muestra de ADN con respecto a otra, por ejemplo para poder determinar la causa de enfermedades o prevenirlas.\\

Un ejemplo sería analizar el ADN de una población (conjunto de individuos) que tengan un determinado tipo de cáncer y otra población que no lo tengan. Estos individuos tendrán muchas similitudes en el ADN puesto que pertenecen a la misma especie, pero también diferirán en otras. Cuando encontremos la secuencia de ADN común a la población con cáncer pero que no aparezca en la población sin cáncer, tendremos la razón de ese cáncer localizada y podremos tratarlo y prevenirlo.\\

El proceso de descubrimiento de variantes tiene tres fases. En la primera fase se obtienen lecturas de ADN en un formato específico y dependiente de la plataforma que las haya obtenido. Lo que se hace con estas lecturas es transformarlas a un único formato genérico, con unas calidades bien calibradas, mapeadas y alineadas con su ADN de referencia. El formato utilizado es el \textit{SAM/BAM} \cite{bamsam} (\textit{Sequence Aligment Map/Binary Alignment Map}), el cual es independiente de la tecnología de obtención del ADN.\\

En la segunda fase se analizan los ficheros \textit{SAM/BAM} para obtener posiciones del ADN que, según evidencia estadística, sean mutaciones respecto al ADN de referencia. Esto incluye diferencias en una sola posición de la cadena de ADN (\textit{SNP}), pequeños \textit{indels}, etc. Esta fase genera ficheros \textit{VCF} que contienen las diferencias con el ADN referencia.\\

En la última fase se analizan las mutaciones obtenidas y la estructura del ADN para generar conclusiones. En la Figura \ref{fig:procesodescubrimiento} se puede ver gráficamente estas tres fases.\\

\begin{figure}
\centering
\includegraphics[width=0.8\textwidth]{variationdiscover.jpg}
\caption{Proceso de descubrimiento de variantes en el ADN.\label{fig:procesodescubrimiento}}
\end{figure} 

\section{Punto de partida}

GATK será la herramienta de referencia para la realización de esta tesis, abarcando parte de la primera fase y la segunda del proceso de descubrimiento de variantes. Según la Figura \ref{fig:procesodescubrimiento}, se quiere implementar el recalibrado de las calidades de las bases (\textit{Base quality recalibration}) de la primera fase del descubrimiento de variantes, desarrollando un recalibrador. También se quiere implementar la segunda fase completa, desarrollando un descubridor de variantes.\\

Las implementaciones tendrán que ser eficientes y aprovechar al máximo todos los recursos computacionales de los que se disponga en el entorno que se ejecuta, por ejemplo en un \textit{cluster}. Es en esto en lo que falla GATK, puesto que solo aprovecha la capacidad de proceso mediante hilos y no utiliza estructuras de datos eficientes ni gestión de memoria óptima (en parte por utilizar Java).\\

\section{Objetivos}

\subsection{Objetivo general}

Desarrollar herramientas que permitan realizar el recalibrado de las calidades de las bases (\textit{Base quality recalibration}) y toda la segunda fase del descubrimiento de variantes. Estas herramientas deberán ser eficientes.\\

\subsection{Objetivos específicos}

El objetivo general de la tesis se puede desglosar en una serie de objetivos específicos, que mediante su cumplimiento permitirán alcanzar el objetivo general:

\begin{itemize}
\item
Implementar un recalibrador que realice la parte del recalibrado de la calidad de las bases y genere ficheros BAM ya recalibrados.
\item
Implementar un descubridor de variantes que realice toda la segunda fase de descubrimiento de variantes y genere ficheros de resultados VCF.
\item
Desarrollar implementaciones lo más eficientes posible, utilizando tecnologías paralelas que permitan explotar los recursos de computo disponibles en cada situación.
	\begin{itemize}
	\item
	Usar las tecnologías disponibles en los microprocesadores para acelerar la ejecución.
	\item
	Usar las capacidades de memoria compartida de los procesadores \textit{multicore}.
	\item
	Usar las capacidades de paso de mensaje de los sistemas multiprocesador o \textit{clusters}.
	\item
	Mantener las comunicaciones entre procesos al mínimo.
	\item
	Reducir el número de operaciones I/O al mínimo. 
	\end{itemize}
\item
Usar estructuras de datos óptimas que permitan aprovechar las características de las arquitecturas y el sistema de memoria de los computadores. Explotar la localidad temporal y espacial de los datos en memoria.
\end{itemize}

\section{Planificación de tareas}

\subsection{Descripción de tareas}

\subsection{Situación actual}